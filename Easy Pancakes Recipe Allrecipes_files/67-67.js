(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{262:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return G}));var n=a(2),o=a.n(n),r=a(1),i=a.n(r),s=a(5),c=a.n(s),l=a(812),d=a.n(l),u=a(778),f=a(4),m=a(780),v=a(773),p=a(905),h=a(862),b=a(787);function g(t,e,a,n,o,r,i){try{var s=t[r](i),c=s.value}catch(t){return void a(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function w(t){return function(){var e=this,a=arguments;return new Promise((function(n,o){var r=t.apply(e,a);function i(t){g(r,n,o,i,s,"next",t)}function s(t){g(r,n,o,i,s,"throw",t)}i(void 0)}))}}var y=i()(document.body),C=y.data("save-with-user-api"),k=y.data("save-with-collection"),j=y.data("save-with-success"),O=!1,x=i()(".modal.save-success-modal"),I=x.length?new u.a(x,"save-success-modal"):null,S=i()(".modal.delete-confirmation-modal"),_=S.length?new u.a(S,"delete-confirmation-modal"):null;function D(t){t.find(".icon-text").html("Saved"),t.addClass("saved"),t.removeClass("saving"),c()(f.tb).broadcast()}function E(t){t.find(".icon-text").html("Save"),t.removeClass("saving"),t.removeClass("saved"),console.log("Removed successfully"),c()(f.tb).broadcast()}function T(){return(T=w(regeneratorRuntime.mark((function t(e){var a,n,r,i,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=y.attr("data-content-graph-id")||"",!(n=a?a.split("/")[1]:"")){t.next=16;break}return t.next=5,Object(b.b)();case 5:return r=t.sent,t.next=8,d.a.post("/user-proxy/getbookmarks",{idToken:r,bookmarkedItemGraphId:n});case 8:i=t.sent,s=o.a.get(i,"data.bookmarks[0]"),(l=o.a.get(s,"udf.collections"))&&l.length&&(O=!0),o.a.get(s,"contentGraphId")===a&&(D(e),c()(f.Eb).broadcast(s)),e.addClass("initialized"),t.next=17;break;case 16:e.addClass("initialized");case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function A(t,e,a){var n=Object(v.a)("/element-api/content-proxy/favorite");i.a.ajax({url:n,type:"GET",data:t,cache:!1,success:function(t,a,n){if(200===n.status){var o=JSON.parse(t);o.IsFavorite&&!0===o.IsFavorite&&(e.find(".icon-text").html("Saved"),e.addClass("saved"),c()(f.tb).broadcast())}}}).fail((function(n){500!==n.status||a||Object(p.a)(A,[t,e])})).always((function(){e.addClass("initialized")}))}function B(t,e,a){if(e.addClass("saving"),C){var n=y.attr("data-caas-sitename")||"",r=y.attr("data-content-graph-id")||"";Object(h.d)(n,r).then((function(t){o.a.get(t,"data.data.saveBookmark.success")&&D(e)})).catch((function(t){e.removeClass("saving");var a=i()(".shareicon-favorite-link"),n=a.data("content-login-url")||a.data("login-url");n&&"login_required"===o.a.get(t,"code")&&(window.location.href=n)}))}else{var s=Object(v.a)("/element-api/content-proxy/favorite");i.a.post(s,t,(function(t){JSON.parse(t).recipeBoxItemID&&D(e)})).fail((function(n){e.removeClass("saving"),500!==n.status||a||Object(p.a)(B,[t,e])}))}}function z(t){var e=t;e||(e=i()(".shareicon-favorite-link")),e.addClass("saving");var a=y.attr("data-caas-sitename")||"",n=y.attr("data-content-graph-id")||"";Object(h.b)(a,n).then((function(t){200===o.a.get(t,"status")&&!0===o.a.get(t,"data.data.deleteBookmark.success")&&(E(e),O=!1,c()(f.Fb).broadcast(n))})).catch((function(t){console.error(t)}))}function F(t,e,a){if(C)O?_.open():z(e);else{e.addClass("saving");var n=Object(v.a)("/element-api/content-proxy/favorite");i.a.ajax({url:n,type:"DELETE",data:t,success:function(t,a,n){200===n.status&&E(e)},error:function(n){e.removeClass("saving"),500!==n.status||a||Object(p.a)(F,[t,e])}})}}function G(){var t=i()(".shareicon-favorite-link"),e=t.data("content-id");function a(){t.length&&(y.hasClass("authenticated")?C?function(t){T.apply(this,arguments)}(t):A({id:e},t):(t.attr("aria-label","".concat(t.attr("aria-label")||""," (opens in a new window)")),c()(f.tb).broadcast()))}a(),document.body.addEventListener(f.e,(function(){a()})),c()(f.o).subscribe((function(a,n){if(n.closest(t).length)if(a.preventDefault(),y.hasClass("authenticated")&&t.hasClass("initialized")&&!t.hasClass("saving")){var o={id:e};t.hasClass("saved")?F(o,t):(B(o,t),k?c()(f.W).broadcast():j&&I.open())}else{var r=t.data("content-login-url");r&&setTimeout((function(){window.open(r,"_self")}),0)}else n.closest(".shareNew__deleteButtonCancel").length?setTimeout((function(){_.close()}),0):n.closest(".shareNew__deleteButtonRemove").length&&setTimeout((function(){z(),_.close()}),0)}));var n=i()(".modal.share-icons"),o="",r="";function s(t,e){t[0].target.classList.contains("modal-active")||(i()(".ugc-comments-add-comment").trigger("click"),e.disconnect())}function l(t,e){i()(".js-ugc-comments-outer-comment-wrap").hasClass("test-ugc-comments__hide")&&i()(window).trigger("revealComments"),t.preventDefault(),o.close();var a=e.data("content-id");document.querySelector(a).scrollIntoView(!0)}n.length&&(r=n.find(".content").html(),o=new u.a(n,"share-icons")),c()(f.o).subscribe((function(t,e){var a=i()(".shareicon-modal-toggle"),n=i()(".shareicon-print-link"),c=n.parents(".article-container"),d=i()(".js-view-comments-btn-comments"),u=i()(".js-view-comments-btn-nocomments");if(Object(m.a)(e,a)){t.preventDefault();var f=e.parents(".docked-sharebar").find(".sharebar-modal").html();!f&&e.parents(".longform-main-container").length&&(f=e.parents(".longform-main-container").find(".longform__shareModal").html());var v=e.parents(".shareicon-modal-toggle").data("share-id");v&&(f=i()("#".concat(v)).find(".content").html(),v+="_share-new"),f?o.open(f):o.open(r),e.get(0).id=e.get(0).id||v||"share-id-".concat((new Date).getTime()),o.$modal.data("source-target-id",e.get(0).id)}else if(Object(m.a)(e,n))t.preventDefault(),o&&o.close(),c.addClass("print-article"),window.print(),c.removeClass("print-article");else if(Object(m.a)(e,d))l(t,d);else if(Object(m.a)(e,u)){if(t.preventDefault(),"#ugc-comments"===u.data("content-id"))if(t.stopPropagation(),i()("body").hasClass("authenticated"))new MutationObserver(s).observe(document.body,{attributes:!0}),o.close();else window.location=u.data("content-login-url");else l(t,u)}})),c()(f.r).subscribe((function(){O=!0})),c()(f.Ob).subscribe((function(t){var e=i()(".icon.icon-print").find("a[href$='?printview']");t.preventDefault(),e.click()}))}},905:function(t,e,a){"use strict";a.d(e,"a",(function(){return d}));var n=a(2),o=a.n(n),r=a(1),i=a.n(r),s=a(773);function c(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function d(t,e){var a=Object(s.a)("/element-api/content-proxy/refresh-cookie");i.a.ajax({url:a,retry:!1,type:"GET",timeout:3e3,xhrFields:{withCredentials:!0},success:function(a){o.a.isArray(a)&&"function"==typeof t&&(o.a.forEach(a,(function(t){document.cookie=t})),t.apply(void 0,c(e).concat([!0])))}})}}}]);
//# sourceMappingURL=67-67.js.map